#pragma GCC diagnostic ignored "-Wincompatible-pointer-types"


#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <XDDQ_åŒæ–¹åˆå§‹ä¿¡æ¯.h>


// 1:å¿…é¡»æ­£ç¡®è¾“å…¥
// 0:å…è®¸ä½¿ç”¨é»˜è®¤å€¼
// int _Settings_input_mode=0;


void Fight_info_show(Fight_info *);
void Fight_info_init(Fight_info *, char *);
void Fight_info_input(Fight_info *, const char *);

void Fight_info_show(Fight_info * self)
{
	printf("æ”»:%g è¡€:%g é˜²:%g æ•:%g\n", self->æ”», self->è¡€, self->é˜², self->æ•);
}

void Fight_info_input(Fight_info * self, const char *prompt)
{
	while (1)
	{
		puts(prompt);
		if (scanf("%g%g%g%g", &self->æ”», &self->è¡€, &self->é˜², &self->æ•) != 4
			|| getchar() != 10)
		{
			puts("âŒè¾“å…¥æ— æ•ˆï¼Œè¯·é‡æ–°è¾“å…¥ã€‚\n");
			while (getchar() != 10);
			continue;
		}
		break;
	}
}

void Fight_info_init(Fight_info * self, char *who)
{
	å½“å‰å¯¹æ‰‹(self,who);
	if (!strcmp(who,"æˆ‘"))
	{
		åº”é¾™æµ(self,5);
		//é¸¾é¸Ÿæµ(self,1.11);
		
	}
	
	//å½“å‰å¯¹æ‰‹_å¦ä¸€ä¸ªå·åæš´çš„(self,who);

	/*if (!strcmp(who,"æ•Œ")) 
	{
		å°†äººç‰©èƒ½åŠ›ç½®ä¸ºé»˜è®¤å€¼(self,1);
		åº”é¾™æµ(self,5);
		self->æ•+=100;
	}
	else 
	{
		å°†äººç‰©èƒ½åŠ›ç½®ä¸ºé»˜è®¤å€¼(self,1);
		åº”é¾™æµ(self,5);
	}*/
	
	
}


/* 
   è½®åºåˆ°ååŒçµå…½(è½®åºæ–¹,å¯¹æ–¹) { if
   (!strcmp(è½®åºæ–¹->ååŒçµå…½åç§°,"è®¡è’™") { å¯¹æ–¹->å¼ºç–—-=0.5;
   å¯¹æ–¹->å‡å¼ºç–—buffå›åˆæ•°+=2; } }


   æ¯å›åˆè‡ªåŠ¨å˜åŒ–() { if (æ¯ä¸€æ–¹->å‡å¼ºç–—buffå›åˆæ•°>0) {
   æ¯ä¸€æ–¹->å‡å¼ºç–—buffå›åˆæ•°-=1; }

   if (æ¯ä¸€æ–¹->å‡å¼ºç–—buffå›åˆæ•°==0) { å¼ºç–— }



   }

   ååŒçµå…½æ˜¯å¦è¡ŒåŠ¨(ååŒçµå…½è¡ŒåŠ¨æ¦‚ç‡) { srand(time(NULL);
   éšæœºæ•°=rand()%100+1; if (in_interval(éšæœºæ•°,1,20)) { return 1ï¼› }
   return 0;

   } */

void ç»Ÿä¸€free(Fight_info *, Fight_info *);
void è½½å…¥ç¥é€šä¸ç²¾æ€ª(Fight_info *, Fight_info *);
void ä¸å—å½±å“çš„è®¡ç®—ä¸æ˜¾ç¤º(Fight_info *, Fight_info *);
void æ£€æŸ¥å¤æ´»(Fight_info *, Fight_info *);
void å¦–æ°”å˜åŒ–(Fight_info *, float);
void æ²»ç–—æº¢å‡ºä¿®æ­£(Fight_info *);
void å—ä¼¤(Fight_info *, Fight_info *, float);
void æ£€æŸ¥ç²¾æ€ª(Fight_info *, Fight_info *, char *, char *);
void ç²¾æ€ªè·Ÿéš(Fight_info *, Fight_info *, char *);
void æ£€æŸ¥äººç‰©è¢«æ™•çŠ¶æ€æ˜¯å¦å¯æ¢å¤(Fight_info *);
void è®¡ç®—å®é™…å‡»æ™•ç‡(Fight_info *, Fight_info *);
int å‡»æ™•ç‡æ˜¯å¦è¶³å¤Ÿ(Fight_info *, Fight_info *);
void è¢«å‡»æ™•(Fight_info *);
void å‡»æ™•åˆ¤å®šåŠç›¸å…³ç»è¿‡(Fight_info *, Fight_info *);
void çµè„‰è·Ÿéš(Fight_info *, char *);
void è¿›è¡Œè¯†æµ·é’‰æµè¡€(Fight_info *, Fight_info *);
void æ£€æŸ¥ç¥é€š(Fight_info *, Fight_info *, char *, char *);
void ç¥é€šè·Ÿéš(Fight_info *, Fight_info *, char *);
void é‡æ–°è®¡ç®—å…¨éƒ¨ä¼¤å®³(Fight_info *, Fight_info *);
float é‡æ–°è®¡ç®—æŒ‡å®šä¼¤å®³(Fight_info *, Fight_info *, char *);
void è®¡ç®—æœ¬æ¬¡ä¼¤å®³(Fight_info *, Fight_info *, char *);
float é‡æ–°è®¡ç®—æŒ‡å®šæ²»ç–—(Fight_info *self, Fight_info *opponent, char *æ²»ç–—ç§ç±»);
void è®¡ç®—æœ¬æ¬¡æ²»ç–—(Fight_info *self, Fight_info *opponent, char *æ²»ç–—ç§ç±»);
void æ²»ç–—(Fight_info *self);
void é‡Šæ”¾é“æ³•(Fight_info *, Fight_info *);
void è¿›è¡Œæ™®æ”»(Fight_info *, Fight_info *);
void è½®åºåˆ°äººç‰©(Fight_info *, Fight_info *);
void è½®åºåˆ°çµå…½(Fight_info *, Fight_info *, int );



void ç»Ÿä¸€free(Fight_info *self, Fight_info *opponent)
{
	
	for (int i=0; i<self->ç²¾æ€ªæ•°é‡; i++)
		free(self->ç²¾æ€ªåˆ†ç»„[i]);

	for (int i=0; i<self->ç¥é€šæ•°é‡; i++)
		free(self->ç¥é€šåˆ†ç»„[i]);

	for (int i=0; i<opponent->ç²¾æ€ªæ•°é‡; i++)
		free(opponent->ç²¾æ€ªåˆ†ç»„[i]);

	for (int i=0; i<opponent->ç¥é€šæ•°é‡; i++)
		free(opponent->ç¥é€šåˆ†ç»„[i]);
		
	
	
	free(self->ç²¾æ€ªåˆ†ç»„);
	free(self->ç¥é€šåˆ†ç»„);
	free(opponent->ç²¾æ€ªåˆ†ç»„);
	free(opponent->ç¥é€šåˆ†ç»„);
	
	free(self->å­˜æ¡£->è§¦å‘è®¡æ•°);
	free(self->å­˜æ¡£);
	
	free(self);
	free(opponent);
}


void è½½å…¥ç¥é€šä¸ç²¾æ€ª(Fight_info * self, Fight_info * opponent)
{
	if (strstr(self->æºå¸¦ç¥é€š, "ç¢å¿ƒæ³•") != NULL || strstr(self->æºå¸¦ç²¾æ€ª, "æ‰¶æ¡‘") != NULL)
	{
		self->å¯å¤æ´»æ¬¡æ•°=1;

	}

	if (strstr(self->æºå¸¦ç¥é€š, "åŒ–ç¾½") != NULL)
	{
		self->æ•*=1.18;
	}

	if (strstr(self->æºå¸¦ç¥é€š, "é“œçš®é“éª¨") != NULL)
	{
		opponent->å¢ä¼¤ç³»æ•°-=0.08;
	}
	
	
	if (strstr(self->æºå¸¦ç²¾æ€ª, "ç ´é˜µä¹¦ç”Ÿ") != NULL)
	{
		self->è¡€ *= 1.12;
	}
	
	if (strstr(self->æºå¸¦ç¥é€š, "é£˜æ¸ºèº«" ) != NULL)
	{
		self->é£˜æ¸ºèº«å‰©ä½™å›åˆæ•° = 3;
	}
	
	if (strstr(self->æºå¸¦ç²¾æ€ª, "ç„å†¥è›Ÿ" ) !=NULL)
	{
		self->æ”»+=self->é˜²*0.6;
	}
	
	if (strstr(self->æºå¸¦ç¥é€š, "å…±é¸£") != NULL )
	{
		self->å¼ºçµç³»æ•°+=0.136;
	}
	
	if (strstr(self->æºå¸¦ç²¾æ€ª, "é©¬é¢") != NULL )
	{
		self->å¼ºçµç³»æ•°+=0.16;
	}
	
	if (strstr(self->æºå¸¦ç²¾æ€ª, "é»‘éº’éºŸ") != NULL )
	{
		self->æˆ˜æ–—æŠ—æ€§ä¹‹æŠ—æ™•+=28;
	}
}



void ä¸å—å½±å“çš„è®¡ç®—ä¸æ˜¾ç¤º(Fight_info * å…ˆæ‰‹æ–¹, Fight_info * åæ‰‹æ–¹)
{
	// è®¡ç®—
	é‡æ–°è®¡ç®—å…¨éƒ¨ä¼¤å®³(å…ˆæ‰‹æ–¹, åæ‰‹æ–¹);
	
	// å±•ç¤ºä¿¡æ¯
	putchar(10);
	printf("[å…ˆæ‰‹æ–¹å¢ä¼¤ç³»æ•°%g|åæ‰‹æ–¹å¢ä¼¤ç³»æ•°%g]\n", å…ˆæ‰‹æ–¹->å¢ä¼¤ç³»æ•°,
		   åæ‰‹æ–¹->å¢ä¼¤ç³»æ•°);
	printf("[å…ˆæ‰‹æ–¹å¼ºçµç³»æ•°%g|åæ‰‹æ–¹å¼ºçµç³»æ•°%g]\n", å…ˆæ‰‹æ–¹->å¼ºçµç³»æ•°,
		   åæ‰‹æ–¹->å¼ºçµç³»æ•°);
	printf("[å…ˆæ‰‹æ–¹æ˜¯åæ‰‹æ–¹çš„%gï¼ˆæ”»å€ï¼‰~%g~%gå€å¯¹æ‰‹]\n",
		   å…ˆæ‰‹æ–¹->æ”»/åæ‰‹æ–¹->æ”», å…ˆæ‰‹æ–¹->è¡€/åæ‰‹æ–¹->è¡€,
		   å…ˆæ‰‹æ–¹->é˜²/åæ‰‹æ–¹->é˜²);
	printf("[åæ‰‹æ–¹æ˜¯å…ˆæ‰‹æ–¹çš„%gï¼ˆæ”»å€ï¼‰~%g~%gå€å¯¹æ‰‹]\n",
		   åæ‰‹æ–¹->æ”»/å…ˆæ‰‹æ–¹->æ”», åæ‰‹æ–¹->è¡€/å…ˆæ‰‹æ–¹->è¡€,
		   åæ‰‹æ–¹->é˜²/å…ˆæ‰‹æ–¹->é˜²);

	printf("[å…ˆæ‰‹æ–¹æœ‰è§†é˜²å¾¡ä¼¤%g%%|åæ‰‹æ–¹æœ‰è§†é˜²å¾¡ä¼¤%g%%]\n",
		   å…ˆæ‰‹æ–¹->æœ‰è§†é˜²å¾¡ä¼¤*100, åæ‰‹æ–¹->æœ‰è§†é˜²å¾¡ä¼¤*100);
	printf("[å…ˆæ‰‹æ–¹æ— è§†é˜²å¾¡ä¼¤%g%%|åæ‰‹æ–¹æ— è§†é˜²å¾¡ä¼¤%g%%]\n",
		   å…ˆæ‰‹æ–¹->æ— è§†é˜²å¾¡ä¼¤*100, åæ‰‹æ–¹->æ— è§†é˜²å¾¡ä¼¤*100);
	printf
		("[å…ˆæ‰‹æ–¹é“æ³•%sä¼¤%g%%+å›è¡€%g%%|åæ‰‹æ–¹é“æ³•%sä¼¤%g%%+å›è¡€%g%%]\n",
		 å…ˆæ‰‹æ–¹->é“æ³•åç§°, å…ˆæ‰‹æ–¹->é“æ³•ä¼¤*100, å…ˆæ‰‹æ–¹->é“æ³•å›è¡€*100,
		 åæ‰‹æ–¹->é“æ³•åç§°, åæ‰‹æ–¹->é“æ³•ä¼¤*100, åæ‰‹æ–¹->é“æ³•å›è¡€*100);
	printf("[å…ˆæ‰‹æ–¹ä¸»çµå…½%sä¼¤%g%%+å›è¡€%g%%|åæ‰‹æ–¹ä¸»çµå…½%sä¼¤%g%%+å›è¡€%g%%]\n",
		   å…ˆæ‰‹æ–¹->ä¸»çµå…½åç§°, å…ˆæ‰‹æ–¹->ä¸»çµå…½ä¼¤*100, å…ˆæ‰‹æ–¹->ä¸»çµå…½å›è¡€*100,
		   åæ‰‹æ–¹->ä¸»çµå…½åç§°, åæ‰‹æ–¹->ä¸»çµå…½ä¼¤*100,
		   åæ‰‹æ–¹->ä¸»çµå…½å›è¡€*100);
	printf
		("[å…ˆæ‰‹æ–¹ååŒçµå…½%sä¼¤%g%%+å›è¡€%g%%|åæ‰‹æ–¹ååŒçµå…½%sä¼¤%g%%+å›è¡€%g%%]\n",
		 å…ˆæ‰‹æ–¹->ååŒçµå…½åç§°, å…ˆæ‰‹æ–¹->ååŒçµå…½ä¼¤*100,
		 å…ˆæ‰‹æ–¹->ååŒçµå…½å›è¡€*100, åæ‰‹æ–¹->ååŒçµå…½åç§°,
		 åæ‰‹æ–¹->ååŒçµå…½ä¼¤*100, åæ‰‹æ–¹->ååŒçµå…½å›è¡€*100);
	printf("[å…ˆæ‰‹æ–¹ç²¾æ€ª%s|åæ‰‹æ–¹ç²¾æ€ª%s]\n", å…ˆæ‰‹æ–¹->æºå¸¦ç²¾æ€ª, åæ‰‹æ–¹->æºå¸¦ç²¾æ€ª);
	printf("[å…ˆæ‰‹æ–¹ç¥é€š%s|åæ‰‹æ–¹ç¥é€š%s]\n", å…ˆæ‰‹æ–¹->æºå¸¦ç¥é€š, åæ‰‹æ–¹->æºå¸¦ç¥é€š);

}



void æ£€æŸ¥å¤æ´»(Fight_info * self, Fight_info * opponent)
{
	Fight_info *å…ˆæ‰‹æ–¹=self, *åæ‰‹æ–¹=opponent;

	if (strstr(self->å“ªä¸€æ–¹, "å") != NULL)
	{
		å…ˆæ‰‹æ–¹=opponent;
		åæ‰‹æ–¹=self;
	}
	
	if (self->å·²æŸç”Ÿå‘½>=1)
	{
		printf("(ç›®å‰:å…ˆæ‰‹æ–¹%g%% VS åæ‰‹æ–¹%g%%)\n", åæ‰‹æ–¹->å·²æŸç”Ÿå‘½*100,
			   å…ˆæ‰‹æ–¹->å·²æŸç”Ÿå‘½*100);
		printf("(ç›®å‰å¦–æ°”:å…ˆæ‰‹æ–¹%d VS åæ‰‹æ–¹ %d)\n", å…ˆæ‰‹æ–¹->å¦–æ°”,
			   åæ‰‹æ–¹->å¦–æ°”);
			   
		if (!self->å¤æ´»æœªèµ·èº« && self->å¯å¤æ´»æ¬¡æ•°<1)
		{
			printf("(%sæ–¹å·²æ­»ï¼Œæ— å¤æ´»)\n", self->å“ªä¸€æ–¹);
			printf("\nğŸ“–\n(%sæ–¹å‘Šè´Ÿ)\n", self->å“ªä¸€æ–¹);
			
			
			//ç»Ÿä¸€free(self,opponent);
			exit(EXIT_SUCCESS);
		}
		else if (self->å¤„äºå†°å†»çŠ¶æ€)
		{
			if (strstr(self->æºå¸¦ç¥é€š, "ç¢å¿ƒæ³•") == NULL)
			{
				printf("(%sæ–¹å·²æ­»ï¼Œæ‰¶æ¡‘è¢«å†°å†»ä¸èƒ½å¤æ´»)\n", self->å“ªä¸€æ–¹);
				printf("\nğŸ“–\n(%sæ–¹å‘Šè´Ÿ)\n", self->å“ªä¸€æ–¹);
				
				//ç»Ÿä¸€free(self,opponent);
				exit(EXIT_SUCCESS);
			}
		}
				

		printf("(%sæ–¹å·²æ­»ï¼Œæœ‰å¤æ´»)\n", self->å“ªä¸€æ–¹);
		self->å¤æ´»æœªèµ·èº«=1;
	}

}



// 0:æ™®æ”»
// -1:åˆšåˆšé‡Šæ”¾å®Œé“æ³•ï¼Œéœ€è¦æ¸…ç©ºå¦–æ°”
// å¤§äº0:å—ä¼¤å¹¶è¾“å…¥å—ä¼¤å€¼
// -800:è¢«å¯¹æ‰‹èš€é­‚å’’
void å¦–æ°”å˜åŒ–(Fight_info * self, float æœ¬æ¬¡æ‰è¡€å¤šå°‘)
{
	if (æœ¬æ¬¡æ‰è¡€å¤šå°‘==-1)
	{
		self->å¦–æ°”=0;
		self->å·²å®Œæˆè¡¥æ°”=0;
		if (!strcmp(self->é“æ³•åç§°, "ä¸ƒåäºŒå˜"))
		{
			self->å¦–æ°”+=3000;
		}
		return;
	}

	if (æœ¬æ¬¡æ‰è¡€å¤šå°‘>0)
	{
		// æ‰è¡€è¡¥æ°”
		self->å¦–æ°”+=æœ¬æ¬¡æ‰è¡€å¤šå°‘*5000;
	}
	else if (æœ¬æ¬¡æ‰è¡€å¤šå°‘==0)
	{
		// æ™®æ”»è¡¥æ°”
		self->å¦–æ°”+=2000;
	}		
	else if (æœ¬æ¬¡æ‰è¡€å¤šå°‘==-800)
	{
		// è¢«èš€é­‚å’’å‡æ°”
		self->å¦–æ°”-=800;
	}

		
	if (self->å¦–æ°”>10000)
		self->å¦–æ°”=10000;	
	else if (self->å¦–æ°”<0)
		self->å¦–æ°”=0;

				
	if (self->å¦–æ°”==10000)
	{
		self->å·²å®Œæˆè¡¥æ°”=1;
	}
	else
	{
		self->å·²å®Œæˆè¡¥æ°”=0;
	}
}



void æ²»ç–—æº¢å‡ºä¿®æ­£(Fight_info * self)
{
	if (self->å·²æŸç”Ÿå‘½<0)
		self->å·²æŸç”Ÿå‘½=0;
}


void å—ä¼¤(Fight_info * self, Fight_info * opponent, float æœ¬æ¬¡æ‰è¡€å¤šå°‘)
{
	if (strstr(self->æºå¸¦ç¥é€š, "é£˜æ¸ºèº«")!=NULL && self->é£˜æ¸ºèº«å‰©ä½™å›åˆæ•°>0)
	{
		æœ¬æ¬¡æ‰è¡€å¤šå°‘ *= (1-0.2);		
	}
	
	float è¢«å¦–æ°”è®¡ç®—çš„æ‰è¡€é‡=æœ¬æ¬¡æ‰è¡€å¤šå°‘;
	
	if (self->å·²æŸç”Ÿå‘½+è¢«å¦–æ°”è®¡ç®—çš„æ‰è¡€é‡>1)
	{
		è¢«å¦–æ°”è®¡ç®—çš„æ‰è¡€é‡=1-self->å·²æŸç”Ÿå‘½;
	}
	
	self->å·²æŸç”Ÿå‘½+=æœ¬æ¬¡æ‰è¡€å¤šå°‘;
	å¦–æ°”å˜åŒ–(self, è¢«å¦–æ°”è®¡ç®—çš„æ‰è¡€é‡);
	æ£€æŸ¥å¤æ´»(self, opponent);
	if (!self->å¤æ´»æœªèµ·èº«)
	{
		ç¥é€šè·Ÿéš(self, opponent, "");
		ç²¾æ€ªè·Ÿéš(self, opponent, "");
	}
}


void æ£€æŸ¥ç²¾æ€ª(Fight_info * self, Fight_info * opponent, char *ç²¾æ€ªåç§°, char *æ—¶åˆ»)
{
	if (!strcmp(ç²¾æ€ªåç§°, "å°é¾™å¥³") && !self->å°é¾™å¥³å·²è§¦å‘ && self->å·²æŸç”Ÿå‘½>=0.7)
	{
		if (self->å¤æ´»æœªèµ·èº«) return;
		printf("ğŸ§¥\n%sç²¾æ€ª%sè§¦å‘\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°);
		opponent->å¢ä¼¤ç³»æ•°-=0.35;
		self->å°é¾™å¥³å·²è§¦å‘=1;
		return;
	}
		
	if (!strcmp(ç²¾æ€ªåç§°, "å±±æ³½ç²¾") && !self->å±±æ³½ç²¾å·²è§¦å‘ && self->å·²æŸç”Ÿå‘½>=0.7)
	{
		if (self->å¤æ´»æœªèµ·èº«) return;
		printf("ğŸŒ³\n%sç²¾æ€ª%sè§¦å‘\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°);
		self->æœ¬æ¬¡æ²»ç–—=0.24;
		æ²»ç–—(self);
		self->å±±æ³½ç²¾å·²è§¦å‘=1;
		return;
	}
	

	if (!strcmp(ç²¾æ€ªåç§°, "å¹²é¥­äºº") && !strcmp(æ—¶åˆ», "å›åˆå¼€å§‹æ—¶"))
	{
		if (self->å¤æ´»æœªèµ·èº«) return;
		if (self->å·²æŸç”Ÿå‘½==0) return;
		printf("â—ï¸%sç²¾æ€ª%sè§¦å‘\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°);
		printf("%sç²¾æ€ªå¹²é¥­äººå›è¡€%g%%\n", self->å“ªä¸€æ–¹, 1.2);
		self->æœ¬æ¬¡æ²»ç–—=0.012;
		æ²»ç–—(self);
		return;
	}

	if (!strcmp(ç²¾æ€ªåç§°, "å¤§æ ‘å¦–") && !strcmp(æ—¶åˆ», "æ™®æ”»å‰")
		&& self->å¤§æ ‘å¦–å±‚æ•°<5)
	{
		self->å¼ºçµç³»æ•°+=0.07;
		self->å¤§æ ‘å¦–å±‚æ•°++;
		printf("â—ï¸%sç²¾æ€ª%sè§¦å‘, ç›®å‰%då±‚",
		 self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°, self->å¤§æ ‘å¦–å±‚æ•°, self->å¼ºçµç³»æ•°);
		 
		if (self->å¤§æ ‘å¦–å±‚æ•°==5) printf("(ç°å·²æ»¡å±‚)");
		printf(", å¼ºçµç³»æ•°%g",self->å¼ºçµç³»æ•°);
		putchar(10);
		return;
	}

	if (!strcmp(ç²¾æ€ªåç§°, "é›·å…¬") && !strcmp(æ—¶åˆ», "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶")
		&& self->é›·å…¬å±‚æ•°<5)
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		self->é›·å…¬å±‚æ•°++;
		è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self,opponent,"é›·å…¬");
		
		printf("â—ï¸%sç²¾æ€ª%sè§¦å‘, ç›®å‰%då±‚, é€ æˆ%g%%ä¼¤å®³, æˆ˜æ–—å±æ€§ä¹‹å‡»æ™•%g%%\n",
			   self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°, self->é›·å…¬å±‚æ•°, self->æœ¬æ¬¡ä¼¤å®³ * 100, self->æˆ˜æ–—å±æ€§ä¹‹å‡»æ™•);
			   
		å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
		return;
	}
	
	if (!strcmp(ç²¾æ€ªåç§°, "ç´«æ™´é¾™ç‹®") && !strcmp(æ—¶åˆ», "å›åˆå¼€å§‹æ—¶"))
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self, opponent, "ç´«æ™´é¾™ç‹®ä¼¤");
		printf("â—ï¸%sç²¾æ€ª%sè§¦å‘\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°);
		printf("%sç²¾æ€ª%sé€ æˆä¼¤å®³%g%%\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°, self->æœ¬æ¬¡ä¼¤å®³*100);
		å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
		return;
	}
	
	if (!strcmp(ç²¾æ€ªåç§°, "çš‡å¸") && !strcmp(æ—¶åˆ», "å›åˆå¼€å§‹æ—¶"))
	{
		if (self->çš‡å¸å·²è§¦å‘) return;
		è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self, opponent, "çš‡å¸ä¼¤");
		printf("â—ï¸%sç²¾æ€ª%sè§¦å‘\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°);
		printf("%sç²¾æ€ª%sé€ æˆä¼¤å®³%g%%\n", self->å“ªä¸€æ–¹, ç²¾æ€ªåç§°, self->æœ¬æ¬¡ä¼¤å®³*100);
		å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);		
		å‡»æ™•åˆ¤å®šåŠç›¸å…³ç»è¿‡(self, opponent);
		self->çš‡å¸å·²è§¦å‘=1;
		return;
	}
}



void ç²¾æ€ªè·Ÿéš(Fight_info * self, Fight_info * opponent, char *æ—¶åˆ»)
{
	if (self->å¤„äºå†°å†»çŠ¶æ€) return;
	
	for (int i = 0; i < self->ç²¾æ€ªæ•°é‡; i++)
	{
		// printf("ç¬¬%d/%d:%s",i+1,self->ç²¾æ€ªæ•°é‡,self->ç²¾æ€ªåˆ†ç»„[i]);
		// getchar();
		æ£€æŸ¥ç²¾æ€ª(self, opponent, self->ç²¾æ€ªåˆ†ç»„[i], æ—¶åˆ»);
	}
}


void æ£€æŸ¥äººç‰©å—æ§çŠ¶æ€æ˜¯å¦å¯æ¢å¤(Fight_info * self)
{
	if (self->å¤„äºè¢«æ™•çŠ¶æ€)
	{
		if (self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨==0)
		{
			self->å¤„äºè¢«æ™•çŠ¶æ€=0;
			printf("âœ…%säººç‰©è¢«æ™•çŠ¶æ€å·²æ¢å¤\n", self->å“ªä¸€æ–¹);
		}
		else
			printf("â—ï¸%säººç‰©è¢«æ™•çŠ¶æ€æœªæ¢å¤\n", self->å“ªä¸€æ–¹);
	}
	
	if (self->å¤„äºå†°å†»çŠ¶æ€)
	{
		if (self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨==0)
		{
			self->å¤„äºå†°å†»çŠ¶æ€=false;
			printf("âœ…%säººç‰©å†°å†»çŠ¶æ€å·²æ¢å¤\n", self->å“ªä¸€æ–¹);
		}
		else
			printf("â—ï¸%säººç‰©å†°å†»çŠ¶æ€æœªæ¢å¤\n", self->å“ªä¸€æ–¹);
	}
	
}


void è®¡ç®—å®é™…å‡»æ™•ç‡(Fight_info *self, Fight_info *opponent)
{
	self->å‡»æ™•ç‡ = self->æˆ˜æ–—å±æ€§ä¹‹å‡»æ™•-opponent->æˆ˜æ–—æŠ—æ€§ä¹‹æŠ—æ™•;	
	
	if (self->å‡»æ™•ç‡<0)
	{
		self->å‡»æ™•ç‡ = 0;
		return;
	}
	
	if (self->å‡»æ™•ç‡>80)
	{
		self->å‡»æ™•ç‡ = 80;
		return;
	}
}


int å‡»æ™•ç‡æ˜¯å¦è¶³å¤Ÿ(Fight_info * self, Fight_info * opponent)
{
	è®¡ç®—å®é™…å‡»æ™•ç‡(self,opponent);
	
	if (self->é™¤äº†è®¾ç½®æ¼æ™•ä»¥å¤–çš„çš†å¿…æ™• && self->æ¼æ™•å‡ æ¬¡==0)
	{
		return 1;
	}
	
	int éšæœºæ•°=0;
	
	éšæœºæ•°=rand() % 100 + 1;
	printf("éšæœºæ•°%d",éšæœºæ•°);
	
	return in_interval(éšæœºæ•°, 1, self->å‡»æ™•ç‡);
}


void è¢«å‡»æ™•(Fight_info * self)
{
	self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨++;
	self->å¤„äºè¢«æ™•çŠ¶æ€=1;
}



void å‡»æ™•åˆ¤å®šåŠç›¸å…³ç»è¿‡(Fight_info *self, Fight_info *opponent)
{
	if (opponent->å¤„äºè¢«æ™•çŠ¶æ€)
	{
		printf("âŒ%säººç‰©ä»ç„¶å¤„äºç”±äºè¢«æ™•é€ æˆçš„ä¸å¯è¡ŒåŠ¨, æ‰€ä»¥ä¸å¯è¢«ç”±å‡»æ™•ä½¿ä¸å¯è¡ŒåŠ¨, æ‰€ä»¥ä¸å¯è¢«%säººç‰©å‡»æ™•\n", opponent->å“ªä¸€æ–¹, self->å“ªä¸€æ–¹);
	}
	else
	{
		if (å‡»æ™•ç‡æ˜¯å¦è¶³å¤Ÿ(self, opponent) && self->æ¼æ™•å‡ æ¬¡<=0)
		{
			printf("â°%säººç‰©æˆåŠŸå‡»æ™•%säººç‰©, ", self->å“ªä¸€æ–¹, opponent->å“ªä¸€æ–¹);
			è¢«å‡»æ™•(opponent);
		}
		else 
		{
			if (self->æ¼æ™•å‡ æ¬¡>0) self->æ¼æ™•å‡ æ¬¡--;
			printf("âŒ%säººç‰©å‡»æ™•å¤±è´¥, ", self->å“ªä¸€æ–¹);
		}
		printf("æ­¤å‰é¢æ¿å‡»æ™•ç‡%g%%, å®é™…å‡»æ™•ç‡%g%%\n",
		 self->æˆ˜æ–—å±æ€§ä¹‹å‡»æ™•-opponent->æˆ˜æ–—æŠ—æ€§ä¹‹æŠ—æ™•, self->å‡»æ™•ç‡);
	}
}


void çµè„‰è·Ÿéš(Fight_info *self, char *æ—¶åˆ»)
{
	if (!strcmp(æ—¶åˆ»,"å›åˆå¼€å§‹æ—¶") && self->æœ±é›€çµè„‰å±‚æ•°>0)
	{
		self->æˆ˜æ–—å±æ€§ä¹‹å‡»æ™•+=6+2*(self->æœ±é›€çµè„‰å±‚æ•°-1);
	}
}


void è¿›è¡Œè¯†æµ·é’‰æµè¡€(Fight_info *self, Fight_info * opponent)
{
	char *æˆ˜å†µç”¨è¯­= self->è¯†æµ·é’‰å·²è§¦å‘?"æ­£åœ¨æµè¡€":"è§¦å‘";
	
	float è¯†æµ·é’‰é™ä¼¤ = self->æ”» * 0.42 ;
			
	if (è¯†æµ·é’‰é™ä¼¤ < self->è¯†æµ·é’‰æ‰è¡€ä¼¤ * opponent->è¡€)
	{
		self->è¯†æµ·é’‰æ‰è¡€ä¼¤ = è¯†æµ·é’‰é™ä¼¤ / opponent->è¡€ ;
	}
			
	printf("â—ï¸%säººç‰©ç¥è¯†ç¥é€šè¯†æµ·é’‰%s, é€ æˆ%g%%ä¼¤å®³\n",
	 self->å“ªä¸€æ–¹, æˆ˜å†µç”¨è¯­, self->è¯†æµ·é’‰æ‰è¡€ä¼¤*100);
	å—ä¼¤(opponent, self, self->è¯†æµ·é’‰æ‰è¡€ä¼¤);
}


void æ£€æŸ¥ç¥é€š(Fight_info * self, Fight_info * opponent, char *ç¥é€šåç§°, char *æ—¶åˆ»)
{
	if (!strcmp(ç¥é€šåç§°, "è¯†æµ·é’‰") )
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		if (!strcmp(æ—¶åˆ», "æ™®æ”»å‰") && !self->è¯†æµ·é’‰å·²è§¦å‘)
		{
			è¿›è¡Œè¯†æµ·é’‰æµè¡€(self, opponent);
			self->è¯†æµ·é’‰å·²è§¦å‘=1;
			return;
		}
		else if (!strcmp(æ—¶åˆ», "å›åˆç»“æŸæ—¶"))
		{
			if (Save_hasChanged(self,"è¯†æµ·é’‰å·²è§¦å‘"))
			{
				Save_update(self, "è¯†æµ·é’‰å·²è§¦å‘");
				return;
			}
			è¿›è¡Œè¯†æµ·é’‰æµè¡€(self, opponent);
			return;
		}
	}
	
	if (!strcmp(ç¥é€šåç§°, "é‡‘åˆšä¸å") )
	{
		if (self->å·²æŸç”Ÿå‘½>=0.7 && self->é‡‘åˆšä¸åå·²è§¦å‘==0)
		{
			if (self->å¤æ´»æœªèµ·èº«) return;
			self->é‡‘åˆšä¸åå·²è§¦å‘=1;
			self->é‡‘åˆšä¸åå‰©ä½™å›åˆæ•°=3;
			printf("ğŸ›\n%säººç‰©è¢«åŠ¨ç¥é€š%så·²è§¦å‘, å‰©ä½™%då›åˆ\n",
			 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->é‡‘åˆšä¸åå‰©ä½™å›åˆæ•°);
		}
		
		if (!strcmp(æ—¶åˆ», "å›åˆç»“æŸæ—¶") && self->é‡‘åˆšä¸åå‰©ä½™å›åˆæ•°>0)
		{
			self->é‡‘åˆšä¸åå‰©ä½™å›åˆæ•°--;
			printf("â—%säººç‰©è¢«åŠ¨ç¥é€š%så‰©ä½™%då›åˆ\n",
			 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->é‡‘åˆšä¸åå‰©ä½™å›åˆæ•°);
		}
		return;
	}
	
	if (!strcmp(ç¥é€šåç§°, "é£˜æ¸ºèº«") && !strcmp(æ—¶åˆ», "å›åˆç»“æŸæ—¶"))
	{
		if (self->é£˜æ¸ºèº«å‰©ä½™å›åˆæ•°>0)
		{
			self->é£˜æ¸ºèº«å‰©ä½™å›åˆæ•°--;
			printf("â—%säººç‰©è¢«åŠ¨ç¥é€š%så‰©ä½™%då›åˆ\n",
			 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->é£˜æ¸ºèº«å‰©ä½™å›åˆæ•°);
		}
		return;
	}
	
	if (!strcmp(ç¥é€šåç§°, "ä¸¹å¿ƒåŒå¹¶") && !strcmp(æ—¶åˆ», "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶"))
	{
		if (self->å¤æ´»æœªèµ·èº«) return;
		self->æœ¬æ¬¡æ²»ç–— = 0.05;
		printf("â—%sçµå…½é‡Šæ”¾æŠ€èƒ½æ—¶è§¦å‘é©­å…½ç¥é€š%s, æ²»ç–—äº†%g%%ç”Ÿå‘½\n",
			 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->æœ¬æ¬¡æ²»ç–— * 100);
		æ²»ç–—(self);
	}
	
	if (!strcmp(ç¥é€šåç§°, "æ‹˜ç¥") && !strcmp(æ—¶åˆ», "æ™®æ”»å‰") && self->æ‹˜ç¥å±‚æ•°<5)
	{	
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		float æœ¬æ¬¡å·å–æ”»å‡»åŠ› = opponent->æ”» * 0.024;
		if (æœ¬æ¬¡å·å–æ”»å‡»åŠ› > self->æ”» * 0.17)
		{
			æœ¬æ¬¡å·å–æ”»å‡»åŠ› = self->æ”» * 0.17;
		}
		 
		self->æ”»+=æœ¬æ¬¡å·å–æ”»å‡»åŠ›;
		opponent->æ”»-=æœ¬æ¬¡å·å–æ”»å‡»åŠ›;
		self->æ‹˜ç¥å±‚æ•°++;
		
		printf("â—ï¸%säººç‰©ç¥è¯†ç¥é€š%sè§¦å‘, ç›®å‰%då±‚%s, æœ¬æ¬¡å·å–%gæ”»å‡»åŠ›\n",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->æ‹˜ç¥å±‚æ•°,
		 self->æ‹˜ç¥å±‚æ•°==5?"(å·²æ»¡å±‚)":"", æœ¬æ¬¡å·å–æ”»å‡»åŠ›);
	}
	
	if (!strcmp(ç¥é€šåç§°, "é™„çµæœ¯") && !strcmp(æ—¶åˆ», "æ™®æ”»å‰"))
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self, opponent, "é™„çµæœ¯ä¼¤");
		
		printf("â—ï¸%säººç‰©ç¥è¯†ç¥é€š%sè§¦å‘, é€ æˆ%g%%ä¼¤å®³\n",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->æœ¬æ¬¡ä¼¤å®³ * 100);
		å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
		return;
	}
	
	if (!strcmp(ç¥é€šåç§°, "å›æ˜¥") && !strcmp(æ—¶åˆ», "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶"))
	{
		if (self->å­˜æ¡£->è§¦å‘è®¡æ•°->å›æ˜¥ !=0) return;
		
		if (self->å¤æ´»æœªèµ·èº«) return;
		
		è®¡ç®—æœ¬æ¬¡æ²»ç–—(self,opponent,"å›æ˜¥");
		
		printf("â—%sçµå…½é‡Šæ”¾æŠ€èƒ½æ—¶è§¦å‘é©­å…½ç¥é€š%s, æ²»ç–—äº†%g%%ç”Ÿå‘½\n",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->æœ¬æ¬¡æ²»ç–— * 100);
		æ²»ç–—(self);
		self->å­˜æ¡£->è§¦å‘è®¡æ•°->å›æ˜¥++;
		return;
	}
	
	if (!strcmp(ç¥é€šåç§°, "é•¿ç”Ÿä½“") && !strcmp(æ—¶åˆ», "å›åˆå¼€å§‹æ—¶"))
	{
		if (self->å¤æ´»æœªèµ·èº«) return;
		
		è®¡ç®—æœ¬æ¬¡æ²»ç–—(self,opponent,"é•¿ç”Ÿä½“");
		
		printf("â—%säººç‰©è¢«åŠ¨ç¥é€š%sè§¦å‘, æ²»ç–—äº†%g%%ç”Ÿå‘½\n",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->æœ¬æ¬¡æ²»ç–— * 100);
		æ²»ç–—(self);
		return;
	}
	
	if (!strcmp(ç¥é€šåç§°, "å…½çµä½“"))
	{
		if (!strcmp(æ—¶åˆ», "å—å‡»"))
		{
			if (self->å¤æ´»æœªèµ·èº«) return;
			if (self->å­˜æ¡£->è§¦å‘è®¡æ•°->å…½çµä½“<10)
			{
				self->å¼ºçµç³»æ•°+=0.03;
				self->å­˜æ¡£->è§¦å‘è®¡æ•°->å…½çµä½“++;
				printf("â—%säººç‰©è¢«åŠ¨ç¥é€š%sè§¦å‘, ç›®å‰%då±‚, å¼ºçµç³»æ•°%g\n",
				self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->å­˜æ¡£->è§¦å‘è®¡æ•°->å…½çµä½“, self->å¼ºçµç³»æ•°);
				return;
			}
		}
		else if (!strcmp(æ—¶åˆ», "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶"))
		{
			self->å¼ºçµç³»æ•°-= 0.03 * self->å­˜æ¡£->è§¦å‘è®¡æ•°->å…½çµä½“;
			self->å­˜æ¡£->è§¦å‘è®¡æ•°->å…½çµä½“=0;
		}
	}
	
	if (!strcmp(ç¥é€šåç§°, "æš—è¢­") && !strcmp(æ—¶åˆ», "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶"))
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self,opponent,"æš—è¢­");
		
		printf("â—%sçµå…½é‡Šæ”¾æŠ€èƒ½æ—¶è§¦å‘é©­å…½ç¥é€š%s, é€ æˆ%g%%ä¼¤å®³\n",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->æœ¬æ¬¡ä¼¤å®³ * 100);
		å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
		return;
	}
	
	if (!strcmp(ç¥é€šåç§°, "å¤§é­”é‚ªèº«") && !strcmp(æ—¶åˆ», "å—å‡»") )
	{
		if (self->å¤æ´»æœªèµ·èº«) return;
		if (self->å­˜æ¡£->è§¦å‘è®¡æ•°->å¤§é­”é‚ªèº«<5)
		{
			self->æ”»*=1.029;
			self->å­˜æ¡£->è§¦å‘è®¡æ•°->å¤§é­”é‚ªèº«++;
			printf("â—%säººç‰©è¢«åŠ¨ç¥é€š%sè§¦å‘, ç›®å‰%då±‚%s, æ”»å‡»åŠ›%g\n",
			 self->å“ªä¸€æ–¹, ç¥é€šåç§°, self->å­˜æ¡£->è§¦å‘è®¡æ•°->å¤§é­”é‚ªèº«,
			 self->å­˜æ¡£->è§¦å‘è®¡æ•°->å¤§é­”é‚ªèº«<5?"":"(å·²æ»¡å±‚)",
			 self->æ”»);
			return;
		}
	}
	
	if (!strcmp(ç¥é€šåç§°, "èš€é­‚å’’") && !strcmp(æ—¶åˆ», "æ™®æ”»å‰"))
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		printf("â—ï¸%säººç‰©ç¥è¯†ç¥é€š%sè§¦å‘, %säººç‰©æ­¤å‰å¦–æ°”%d",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, opponent->å“ªä¸€æ–¹, opponent->å¦–æ°”);
		
		å¦–æ°”å˜åŒ–(opponent,-800);
		printf(", ç›®å‰å¦–æ°”%d\n",opponent->å¦–æ°”);
		
		return;
	}
	
	
	if (!strcmp(ç¥é€šåç§°, "åçµ") && !strcmp(æ—¶åˆ», "æ™®æ”»å‰"))
	{
		if (opponent->å¤æ´»æœªèµ·èº«) return;
		
		self->å‰©ä½™ç”Ÿå‘½=1-self->å·²æŸç”Ÿå‘½;
		float æœ¬æ¬¡åçµæ‰è¡€_è‡ªå·±=self->å‰©ä½™ç”Ÿå‘½*0.1;
		float æœ¬æ¬¡åçµæ‰è¡€_å¯¹æ–¹=self->è¡€*self->å‰©ä½™ç”Ÿå‘½*0.1/opponent->è¡€;
		
		printf("â—ï¸%säººç‰©ç¥è¯†ç¥é€š%sè§¦å‘, è‡ªå·±æ‰è¡€%g%%,å¯¹æ–¹æ‰è¡€%g%%\n",
		 self->å“ªä¸€æ–¹, ç¥é€šåç§°, æœ¬æ¬¡åçµæ‰è¡€_è‡ªå·± * 100, æœ¬æ¬¡åçµæ‰è¡€_å¯¹æ–¹*100);
		å—ä¼¤(self,opponent,æœ¬æ¬¡åçµæ‰è¡€_è‡ªå·±);
		å—ä¼¤(opponent, self, æœ¬æ¬¡åçµæ‰è¡€_å¯¹æ–¹);
		return;
	}
}

void ç¥é€šè·Ÿéš(Fight_info * self, Fight_info * opponent, char *æ—¶åˆ»)
{
	for (int i = 0; i < self->ç¥é€šæ•°é‡; i++)
	{
		æ£€æŸ¥ç¥é€š(self, opponent, self->ç¥é€šåˆ†ç»„[i], æ—¶åˆ»);
	}
}

// ä½¿ç”¨å¥‡æŠ€æ·«å·§
void é‡æ–°è®¡ç®—å…¨éƒ¨ä¼¤å®³(Fight_info *self, Fight_info *opponent)
{
	// åŒæ–¹æ— è§†é˜²å¾¡ä¼¤
	self->æ— è§†é˜²å¾¡ä¼¤=self->æ”»/opponent->è¡€;
	opponent->æ— è§†é˜²å¾¡ä¼¤=opponent->æ”»/self->è¡€;

	// æ ‡å‡†å…³ç³»ä¸­ï¼Œé˜²å¾¡ä»£è¡¨çš„æ‰è¡€ä¼¤å›ºå®šä¸º1.66%ï¼ˆå‡†ç¡®å€¼1/6ï¼‰
	// å¥‡æŠ€æ·«å·§ï¼šæœ‰è§†é˜²å¾¡ä¼¤=æ— è§†é˜²å¾¡ä¼¤-é˜²å¾¡ä»£è¡¨çš„æ‰è¡€ä¼¤
	self->æœ‰è§†é˜²å¾¡ä¼¤=self->æ— è§†é˜²å¾¡ä¼¤-opponent->é˜²/opponent->è¡€;

	opponent->æœ‰è§†é˜²å¾¡ä¼¤=opponent->æ— è§†é˜²å¾¡ä¼¤-self->é˜²/self->è¡€;

	// åŒæ–¹é“æ³•ä¼¤æˆ–é“æ³•å›è¡€
	// å¥‡æŠ€æ·«å·§ï¼šé“æ³•åŠ æˆï¼ˆåŠ åœ¨æœ‰è§†é˜²å¾¡ä¸Šï¼‰=æ— è§†é˜²å¾¡ä¼¤*(é“æ³•å€ç‡-1)
	self->é“æ³•ä¼¤=self->æœ‰è§†é˜²å¾¡ä¼¤+self->æ— è§†é˜²å¾¡ä¼¤*(self->é“æ³•ä¼¤å€ç‡_ä¹˜åœ¨æ”»-1);
	self->é“æ³•å›è¡€=self->æ”»*self->
		é“æ³•å›è¡€å€ç‡_ä¹˜åœ¨æ”»/self->è¡€;
	opponent->é“æ³•ä¼¤=opponent->æœ‰è§†é˜²å¾¡ä¼¤+opponent->æ— è§†é˜²å¾¡ä¼¤*(opponent->é“æ³•ä¼¤å€ç‡_ä¹˜åœ¨æ”»-1);


	// åŒæ–¹ä¸»çµå…½
	// å¥‡æŠ€æ·«å·§ï¼šä¸»çµå…½æ‰è¡€ä¼¤=(ä¸»çµå…½å€ç‡/å¯¹æ‰‹å€æ•°*10)%
	self->ä¸»çµå…½ä¼¤=self->æ— è§†é˜²å¾¡ä¼¤*self->ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»;
	opponent->ä¸»çµå…½ä¼¤=opponent->æ— è§†é˜²å¾¡ä¼¤*opponent->ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»;

	self->ä¸»çµå…½å›è¡€=self->æ”»*self->
		ä¸»çµå…½å›è¡€å€ç‡_ä¹˜åœ¨æ”»/self->è¡€;
	opponent->ä¸»çµå…½å›è¡€=opponent->æ”»*opponent->
		ä¸»çµå…½å›è¡€å€ç‡_ä¹˜åœ¨æ”»/opponent->è¡€;
		
	// åŒæ–¹ååŒçµå…½
	self->ååŒçµå…½ä¼¤=self->æ— è§†é˜²å¾¡ä¼¤*self->
		ååŒçµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»;
	opponent->ååŒçµå…½ä¼¤=opponent->æ— è§†é˜²å¾¡ä¼¤*opponent->
		ååŒçµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”»;

	self->ååŒçµå…½å›è¡€=self->æ”»*self->
		ååŒçµå…½å›è¡€å€ç‡_ä¹˜åœ¨æ”»/self->è¡€;
	opponent->ååŒçµå…½å›è¡€=opponent->æ”»*opponent->
		ååŒçµå…½å›è¡€å€ç‡_ä¹˜åœ¨æ”»/opponent->è¡€;

	self->ä¸»çµå…½ä¼¤ = self->æ”» * self->ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”» / opponent->è¡€;
	
}

// ä½¿ç”¨åŸå¼ï¼Œéå¥‡æŠ€æ·«å·§
float é‡æ–°è®¡ç®—æŒ‡å®šä¼¤å®³(Fight_info *self, Fight_info *opponent, char *ä¼¤å®³ç§ç±»)
{
	if (!strcmp(ä¼¤å®³ç§ç±», "ä¸»çµå…½ä¼¤"))
	{
		self->ä¸»çµå…½ä¼¤ = self->æ”» * self->ä¸»çµå…½ä¼¤å€ç‡_ä¹˜åœ¨æ”» / opponent->è¡€ * self->å¼ºçµç³»æ•° * self->å¢ä¼¤ç³»æ•°;
		return self->ä¸»çµå…½ä¼¤;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "æœ‰è§†é˜²å¾¡ä¼¤"))
	{
		self->æœ‰è§†é˜²å¾¡ä¼¤ = (self->æ”» - opponent->é˜²) / opponent->è¡€ * self->å¢ä¼¤ç³»æ•°;
		return self->æœ‰è§†é˜²å¾¡ä¼¤;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "é“æ³•ä¼¤"))
	{
		self->é“æ³•ä¼¤ = (self->æ”» * self->é“æ³•ä¼¤å€ç‡_ä¹˜åœ¨æ”» - self->é˜²) / opponent->è¡€ * self->å¢ä¼¤ç³»æ•°;
		return self->é“æ³•ä¼¤;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "ç´«æ™´é¾™ç‹®ä¼¤"))
	{
		return self->æ”» * 0.2 / opponent->è¡€ * self->å¢ä¼¤ç³»æ•°;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "é™„çµæœ¯ä¼¤"))
	{
		opponent->å‰©ä½™ç”Ÿå‘½ = 1 - opponent->å·²æŸç”Ÿå‘½;
		float é™„çµæœ¯æ‰è¡€ä¼¤ = opponent->å‰©ä½™ç”Ÿå‘½ * 0.042;
		float é™„çµæœ¯é™ä¼¤= self->æ”» * 0.63 / opponent->è¡€;
		
		if (é™„çµæœ¯é™ä¼¤ < é™„çµæœ¯æ‰è¡€ä¼¤)
		{
			é™„çµæœ¯æ‰è¡€ä¼¤ = é™„çµæœ¯é™ä¼¤;
		}
		return é™„çµæœ¯æ‰è¡€ä¼¤ * self->å¢ä¼¤ç³»æ•°;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "çš‡å¸ä¼¤"))
	{
		return self->æ”» * 1.3 / opponent->è¡€ * self->å¢ä¼¤ç³»æ•°;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "æš—è¢­"))
	{
		return self->æ”» * 0.26 / opponent->è¡€ * self->å¢ä¼¤ç³»æ•°;
	}
	
	if (!strcmp(ä¼¤å®³ç§ç±», "é›·å…¬"))
	{
		return self->æ”» * 0.2 / opponent->è¡€ * self->å¢ä¼¤ç³»æ•°;
	}
	
	
}

// ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ä¼¤å®³
void è®¡ç®—æœ¬æ¬¡ä¼¤å®³(Fight_info *self, Fight_info *opponent, char *ä¼¤å®³ç§ç±»)
{
	self->æœ¬æ¬¡ä¼¤å®³ = é‡æ–°è®¡ç®—æŒ‡å®šä¼¤å®³(self,opponent,ä¼¤å®³ç§ç±»);	
	if (opponent->é£˜æ¸ºèº«å‰©ä½™å›åˆæ•°>0)
	{
		self->æœ¬æ¬¡ä¼¤å®³*=(1-0.2);
	}
	// äººç‰©ä¼¤å®³ç®¡ç†
	if (strstr(ä¼¤å®³ç§ç±»,"é“æ³•") || strstr(ä¼¤å®³ç§ç±»,"æœ‰è§†"))
	{
		// é¬¼å°†ï¼š60%â†‘ 1.32
		if (strstr(self->æºå¸¦ç²¾æ€ª, "é¬¼å°†"))
		{
			opponent->å‰©ä½™ç”Ÿå‘½ = 1 - opponent->å·²æŸç”Ÿå‘½;
			if (opponent->å‰©ä½™ç”Ÿå‘½ >= 0.6 )
			{
				printf("ğŸ—¡\n%sç²¾æ€ªé¬¼å°†è§¦å‘\n",self->å“ªä¸€æ–¹);
				self->æœ¬æ¬¡ä¼¤å®³ *= 1.32;
			}
		}
		
		// éª¨é­…ï¼š35%â†“ 1.45
		if (strstr(self->æºå¸¦ç²¾æ€ª, "éª¨é­…"))
		{
			opponent->å‰©ä½™ç”Ÿå‘½ = 1 - opponent->å·²æŸç”Ÿå‘½;
			if (opponent->å‰©ä½™ç”Ÿå‘½ <= 0.35 )
			{
				printf("ğŸ—¡\n%sç²¾æ€ªéª¨é­…è§¦å‘\n",self->å“ªä¸€æ–¹);
				self->æœ¬æ¬¡ä¼¤å®³ *= 1.45;
			}
		}
		
		
		
		// æ“çºµæˆ˜å†µï¼šè‡ªå·±è®¾ç½®çš„äººç‰©æ™®æ”»é¢å¤–ä¼¤
		if (self->é¢å¤–ä¼¤é™å®šå›åˆæ•°>0)
		{
			self->æœ¬æ¬¡ä¼¤å®³ += self->è‡ªè¡Œè®¾ç½®é¢å¤–ä¼¤;
			self->é¢å¤–ä¼¤é™å®šå›åˆæ•°--;
		}
	}
	
	
	if (opponent->é‡‘åˆšä¸åå‰©ä½™å›åˆæ•°>0 && self->æœ¬æ¬¡ä¼¤å®³>0.08)
	{
		self->æœ¬æ¬¡ä¼¤å®³ = 0.08;
	}
}

float é‡æ–°è®¡ç®—æŒ‡å®šæ²»ç–—(Fight_info *self, Fight_info *opponent, char *æ²»ç–—ç§ç±»)
{
	if (!strcmp(æ²»ç–—ç§ç±», "é“æ³•å›è¡€"))
	{
		self->é“æ³•å›è¡€ = self->æ”» * self->é“æ³•å›è¡€å€ç‡_ä¹˜åœ¨æ”» / self->è¡€;
		return self->é“æ³•å›è¡€;
	}
	
	if (!strcmp(æ²»ç–—ç§ç±», "ä¸»çµå…½å›è¡€"))
	{
		self->ä¸»çµå…½å›è¡€ = self->æ”» * self->ä¸»çµå…½å›è¡€å€ç‡_ä¹˜åœ¨æ”» / self->è¡€ * self->å¼ºçµç³»æ•°;
		return self->ä¸»çµå…½å›è¡€;
	}
	
	if (!strcmp(æ²»ç–—ç§ç±», "å›æ˜¥"))
	{
		return self->å·²æŸç”Ÿå‘½ * 0.22;
	}
	
	if (!strcmp(æ²»ç–—ç§ç±», "é•¿ç”Ÿä½“"))
	{
		return self->å·²æŸç”Ÿå‘½ * 0.057;
		
	}
}


void è®¡ç®—æœ¬æ¬¡æ²»ç–—(Fight_info *self, Fight_info *opponent, char *æ²»ç–—ç§ç±»)
{
	self->æœ¬æ¬¡æ²»ç–— = é‡æ–°è®¡ç®—æŒ‡å®šæ²»ç–—(self, opponent, æ²»ç–—ç§ç±»);
}

void æ²»ç–—(Fight_info *self)
{
	self->å·²æŸç”Ÿå‘½-=self->æœ¬æ¬¡æ²»ç–—;
	æ²»ç–—æº¢å‡ºä¿®æ­£(self);
}

void é‡Šæ”¾é“æ³•(Fight_info *self, Fight_info *opponent)
{
	if (self->é“æ³•ä¼¤å€ç‡_ä¹˜åœ¨æ”» != 0)
	{
		è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self, opponent, "é“æ³•ä¼¤");
		printf("%säººç‰©é“æ³•ç¥é€š%sæ”»å‡»åŠ›ä¼¤%g%%\n", self->å“ªä¸€æ–¹, self->é“æ³•åç§°, self->æœ¬æ¬¡ä¼¤å®³ * 100);
		å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
	}
	
	if (self->é“æ³•å›è¡€å€ç‡_ä¹˜åœ¨æ”» != 0)
	{
		è®¡ç®—æœ¬æ¬¡æ²»ç–—(self, opponent, "é“æ³•å›è¡€");
		printf("%säººç‰©é“æ³•ç¥é€š%sæ”»å‡»åŠ›å›è¡€%g%%\n",
		 self->å“ªä¸€æ–¹, self->é“æ³•åç§°,  self->æœ¬æ¬¡æ²»ç–—*100);
		æ²»ç–—(self);
	}
	
	if (!strcmp(self->é“æ³•åç§°, "äº”è¡Œè¡¥ç¼º"))
	{
		self->æœ¬æ¬¡æ²»ç–—=self->å·²æŸç”Ÿå‘½*0.2;
		printf("%säººç‰©é“æ³•ç¥é€š%sæ•ˆæœå›è¡€%g%%\n",
		 self->å“ªä¸€æ–¹, self->é“æ³•åç§°,  self->æœ¬æ¬¡æ²»ç–—*100);
		æ²»ç–—(self);		
	}
	
	
	å¦–æ°”å˜åŒ–(self, -1);
	
	if (!strcmp(self->é“æ³•åç§°, "å†°å°åƒé‡Œ"))
	{
		if (!opponent->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨)
		{
			opponent->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨++;
			opponent->å¤„äºå†°å†»çŠ¶æ€=true;
		}
	}
}



void è¿›è¡Œæ™®æ”»(Fight_info *self, Fight_info *opponent)
{
	è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self, opponent, "æœ‰è§†é˜²å¾¡ä¼¤");
	printf("%säººç‰©æ™®æ”»%g%%\n", self->å“ªä¸€æ–¹, self->æœ¬æ¬¡ä¼¤å®³ * 100);
	å¦–æ°”å˜åŒ–(self, 0);
	å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
}


void è§£å¤æ´»æœªèµ·èº«(Fight_info *self, Fight_info *opponent)
{
	Fight_info *å…ˆæ‰‹æ–¹=self, *åæ‰‹æ–¹=opponent;

	if (strstr(self->å“ªä¸€æ–¹, "å") != NULL)
	{
		å…ˆæ‰‹æ–¹=opponent;
		åæ‰‹æ–¹=self;
	}
	
	if (self->å¤æ´»æœªèµ·èº« && self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨==0)
	{
		self->å¤æ´»æœªèµ·èº«=0;
		short æ˜¯ç¢å¿ƒæ³•å¤æ´»çš„=(strstr(self->æºå¸¦ç¥é€š, "ç¢å¿ƒæ³•")!=NULL);
		self->å·²æŸç”Ÿå‘½=(1 - (æ˜¯ç¢å¿ƒæ³•å¤æ´»çš„?self->ç¢å¿ƒæ³•å›è¡€:self->æ‰¶æ¡‘å›è¡€));
		self->å¯å¤æ´»æ¬¡æ•°--;
		
		printf("âš¡ï¸ï¸(ç›®å‰:å…ˆæ‰‹æ–¹%g%% VS åæ‰‹æ–¹%g%%)\n", åæ‰‹æ–¹->å·²æŸç”Ÿå‘½*100,
				   å…ˆæ‰‹æ–¹->å·²æŸç”Ÿå‘½*100);
		
		if (æ˜¯ç¢å¿ƒæ³•å¤æ´»çš„)
		{
			ç¥é€šè·Ÿéš(self,opponent,"");
			ç²¾æ€ªè·Ÿéš(self,opponent,"");
		}
		else
		{
			ç²¾æ€ªè·Ÿéš(self,opponent,"");
			ç¥é€šè·Ÿéš(self,opponent,"");
		}
	}
}


void è½®åºåˆ°äººç‰©(Fight_info *self, Fight_info *opponent)
{
	if (Save_hasChanged(self,"è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨"))
	{
		printf("â­ï¸%säººç‰©éœ€è¦å› ä¸ºè¢«æ™•å¤±å»%dæ¬¡è¡ŒåŠ¨\n", self->å“ªä¸€æ–¹, self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨);
		Save_update(self,"è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨");
	}
	if (Save_hasChanged(opponent,"å¤æ´»æœªèµ·èº«"))
	{
		printf("â­ï¸%säººç‰©å¤æ´»æœªèµ·èº«:%s\n", opponent->å“ªä¸€æ–¹, opponent->å¤æ´»æœªèµ·èº«?"æ˜¯":"å¦");
		Save_update(opponent,"å¤æ´»æœªèµ·èº«");
	}
	if (Save_hasChanged(self,"è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨"))
	{
		printf("â­ï¸%säººç‰©éœ€è¦å› ä¸ºè¢«å†°å†»å¤±å»%dæ¬¡è¡ŒåŠ¨\n", self->å“ªä¸€æ–¹, self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨);
		Save_update(self,"è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨");
	}
	
	
	
	if (self->å¤æ´»æœªèµ·èº«)
	{
		if (self->å¤„äºå†°å†»çŠ¶æ€)
		{
			if (strstr(self->æºå¸¦ç¥é€š, "ç¢å¿ƒæ³•") == NULL)
			{
				printf("(%sæ–¹å·²æ­»ï¼Œæ‰¶æ¡‘è¢«å†°å†»ä¸èƒ½å¤æ´»)\n", self->å“ªä¸€æ–¹);
				printf("\nğŸ“–\n(%sæ–¹å‘Šè´Ÿ)\n", self->å“ªä¸€æ–¹);
				
				//ç»Ÿä¸€free(self,opponent);
				exit(EXIT_SUCCESS);
			}
			
			self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨--;
			if (self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨<0) self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨=0;
			return;
		}
		else
		{
			printf("(%så¤æ´»æœªèµ·èº«:%s å¯å¤æ´»æ¬¡æ•°:%d)\n",
			 self->å“ªä¸€æ–¹, self->å¤æ´»æœªèµ·èº«?"æ˜¯":"å¦", self->å¯å¤æ´»æ¬¡æ•°);
			è§£å¤æ´»æœªèµ·èº«(self,opponent);
		}
	}
	
	if (!opponent->å¤æ´»æœªèµ·èº« && !(self->å¤„äºå†°å†»çŠ¶æ€ || self->å¤„äºè¢«æ™•çŠ¶æ€))
	{
		ç²¾æ€ªè·Ÿéš(self, opponent, "æ™®æ”»å‰");
		ç¥é€šè·Ÿéš(self, opponent, "æ™®æ”»å‰");
		ç¥é€šè·Ÿéš(opponent, self, "å—å‡»");
		å‡»æ™•åˆ¤å®šåŠç›¸å…³ç»è¿‡(self, opponent);
			
		if (self->å·²å®Œæˆè¡¥æ°”)
			é‡Šæ”¾é“æ³•(self, opponent);
		else è¿›è¡Œæ™®æ”»(self, opponent);
	}
	else
	{
		if (self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨>0)
		{
			self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨--;
			if (self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨<0) self->è¢«å†°å†»çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨=0;
		}
		
		if (self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨>0)
		{
			self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨--;
			if (self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨<0) self->è¢«æ™•çš„éœ€è¦å¤±å»å‡ æ¬¡è¡ŒåŠ¨=0;
		}
	}
	
}


void è½®åºåˆ°çµå…½(Fight_info *self, Fight_info *opponent, int ç¬¬å‡ å›åˆ)
{
	if ((ç¬¬å‡ å›åˆ + 1) % self->ä¸»çµå…½å‡ºæ‰‹é¢‘ç‡ == 0)
	{
		if (self->ä¸»çµå…½å›è¡€å€ç‡_ä¹˜åœ¨æ”» != 0)
		{
			if (self->å¤æ´»æœªèµ·èº«) return;
			è®¡ç®—æœ¬æ¬¡æ²»ç–—(self, opponent, "ä¸»çµå…½å›è¡€");
			printf("%sä¸»çµå…½%så›è¡€%g%%\n", self->å“ªä¸€æ–¹, self->ä¸»çµå…½åç§°, self->æœ¬æ¬¡æ²»ç–— * 100);
			æ²»ç–—(self);
		}
		else
		{
			if (opponent->å¤æ´»æœªèµ·èº«) return;
			è®¡ç®—æœ¬æ¬¡ä¼¤å®³(self, opponent, "ä¸»çµå…½ä¼¤");	
			printf("%sä¸»çµå…½%s%g%%\n", self->å“ªä¸€æ–¹, self->ä¸»çµå…½åç§°, self->æœ¬æ¬¡ä¼¤å®³ * 100);
			å—ä¼¤(opponent, self, self->æœ¬æ¬¡ä¼¤å®³);
		}
		ç²¾æ€ªè·Ÿéš(self, opponent, "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶");
		ç¥é€šè·Ÿéš(self, opponent, "çµå…½é‡Šæ”¾æŠ€èƒ½æ—¶");
	}
}

#pragma GCC diagnostic warning "-Wincompatible-pointer-types"